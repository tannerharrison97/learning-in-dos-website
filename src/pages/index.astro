---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const recentPosts = allPosts
  .sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime())
  .slice(0, 3);
---

<Layout title="Home">
  <section class="hero">
    <div class="container">
      <img src="/logo.png" alt="Learning in Dos" class="hero-logo" />
      <h1>Raising Bilingual Kids, Together</h1>
      <p>We're two English-speaking parents raising our kids to speak Spanish. Join us as we share our journey, tips, and community resources.</p>
      <div class="hero-buttons">
        <a href="/playgroups" class="btn btn-primary">Join a Play Group</a>
        <a href="/blog" class="btn btn-secondary">Read Our Blog</a>
      </div>
    </div>
  </section>

  <section class="features">
    <div class="container">
      <div class="features-grid">
        <a href="/playgroups" class="card card-link">
          <h3>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Play Groups</h3>
          <p>Connect with other families in our Spanish-speaking play groups.</p>
        </a>
        <a href="/blog" class="card card-link">
          <h3>ğŸ“ Our Blog</h3>
          <p>Real stories and practical tips from our bilingual parenting journey.</p>
        </a>
        <div class="card">
          <h3>ğŸ¯ Resources</h3>
          <p>Coming Soon!</p>
        </div>
      </div>
    </div>
  </section>

  {recentPosts.length > 0 && (
    <section class="recent-posts">
      <div class="container">
        <h2>Latest Posts</h2>
        <div class="posts-grid">
          {recentPosts.map((post) => (
            <a href={`/blog/${post.slug}`} class="card post-card">
              <time>{new Date(post.data.pubDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</time>
              <h3>{post.data.title}</h3>
              <p>{post.data.description}</p>
            </a>
          ))}
        </div>
        <p class="text-center" style="margin-top: 2rem;">
          <a href="/blog" class="btn btn-secondary">View All Posts â†’</a>
        </p>
      </div>
    </section>
  )}
</Layout>

<style>
  .hero {
    text-align: center;
    padding: 4rem 0;
    background: linear-gradient(to bottom, var(--white), var(--cream));
  }

  .hero-logo {
    max-width: 200px;
    margin-bottom: 1.5rem;
  }

  .hero h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .hero p {
    font-size: 1.2rem;
    color: var(--gray);
    max-width: 600px;
    margin: 0 auto 2rem;
  }

  .hero-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .features {
    padding: 4rem 0;
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
  }

  .features .card h3 {
    margin-bottom: 0.5rem;
  }

  .recent-posts {
    padding: 4rem 0;
    background: var(--gray-light);
  }

  .recent-posts h2 {
    text-align: center;
    margin-bottom: 2rem;
  }

  .posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
  }

  .post-card {
    display: block;
    color: inherit;
    transition: transform 0.2s;
  }

  .post-card:hover {
    transform: translateY(-4px);
    text-decoration: none;
  }

  .post-card time {
    font-size: 0.85rem;
    color: var(--gray);
  }

  .post-card h3 {
    margin: 0.5rem 0;
    color: var(--blue);
  }

  .post-card p {
    color: var(--gray);
    font-size: 0.95rem;
  }

  .card-link {
    display: block;
    color: inherit;
    transition: transform 0.2s;
  }

  .card-link:hover {
    transform: translateY(-4px);
    text-decoration: none;
  }
</style>
